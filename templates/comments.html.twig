<div class="form-group">
    <label for="name">Nom :</label>
    <input type="text" id="name" name="name" class="form-control" required>
</div>
<div class="form-group">
    <label for="rating">Nombre d'étoiles :</label>
    <input type="number" id="rating" name="rating" class="form-control" min="1" max="5" required>
</div>
<div class="form-group">
    <label for="comment">Commentaire :</label>
    <textarea id="comment" name="comment" class="form-control" rows="4" required></textarea>
</div>
<!-- Champ caché pour l'état de modération -->
<input type="hidden" id="moderation" name="moderation" value="0">
<button type="submit" class="btn btn-primary">Soumettre</button>


<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById("comment-form");
    const commentContainer = document.getElementById("comment-container");

    form.addEventListener("submit", function(event) {
        event.preventDefault();

        const name = form.querySelector("#name").value;
        const rating = form.querySelector("#rating").value;
        const comment = form.querySelector("#comment").value;
        const moderation = form.querySelector("#moderation").value; // Récupérez l'état de modération

        // Créez un objet JSON pour envoyer les données au contrôleur Symfony
        const data = {
            name: name,
            rating: rating,
            comment: comment,
            moderation: moderation
        };

        // Utilisez fetch pour envoyer les données au contrôleur Symfony
        fetch("/add-comment", {
            method: "POST",
            body: JSON.stringify(data),
            headers: {
                "Content-Type": "application/json"
            }
        })
        .then(response => response.json())
        .then(result => {
            // Traitement de la réponse (par exemple, afficher le commentaire en attente de validation)
            const testimonial = document.createElement("div");
            testimonial.className = "single-testimonial";
            // Créez le contenu HTML du commentaire

            const stars = '<i class="fas fa-star"></i>'.repeat(rating);
            testimonial.innerHTML = `
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">${name}</h5>
                        <p class="card-text">${comment}</p>
                        <p class="card-text">${stars}</p>
                    </div>
                </div>
            `;

            commentContainer.appendChild(testimonial);
            form.reset();
        })
        .catch(error => {
            console.error("Erreur : " + error);
        });
    });
});

</script>